---
---
{% include admin/head.html %}

<style>

   .custom-file {
      padding: 0 15px;
   }

   #customFile .custom-file-control::after {
      content: "Zgjedh një dataset...";
   }

   #customFile .custom-file-control::before {
      content: "Shto";
   }

   /*when a value is selected, this class removes the content */
   .custom-file-control.selected::after {
      content: "" !important;
   }
</style>

<script>

   var APIBaseUrl = {{ site.requesturl }}

   // Checking if user is not logged in
   if (localStorage.getItem('token') == null) {
      window.location.href = "{{ site.basepath }}/login";
   }

   var hashValue = window.location.hash.substr(1);

   $(document).ready(() => {
      const getProfile = () => {
         $.ajax({
            url: APIBaseUrl + '/profile',
            type: 'GET',
            dataType: 'json',
            headers: {
               'Content-Type': 'application/json',
               'x-access-token': localStorage.getItem('token')
            },
            crossDomain: true,
            success: data => {
               $('#fullName').html(`${data.firstName} ${data.lastName}`);
               $('#email').html(`${data.email}`);
            },
            error: err => {
               console.log(err);
            }
         });
      }

      if(hashValue == '' || hashValue == 'profile') {
         $('#data-cont').hide();
         getProfile();
      } else if (hashValue == 'data') {
         $('.nav-item').removeClass('active');
         $('#dataLink').addClass('active');
         $('#profile-cont').hide();
         $('#data-cont').show();
      }

      $('#profileLink').click(() => {
         $('.nav-item').removeClass('active');
         $('#profileLink').addClass('active');
         $('#data-cont').hide();
         $('#profile-cont').show();
         getProfile();
      });

      $('#dataLink').click(() => {
         $('.nav-item').removeClass('active');
         $('#dataLink').addClass('active');
         $('#profile-cont').hide();
         $('#data-cont').show();
      })


      $('#import-data-form').on('submit', e => {
         e.preventDefault();

         console.log('submitted!');
      });
   });

   // Logging out the user
   $(document).on('click', '#logout', e => {
      e.preventDefault();
      localStorage.removeItem('token');
      window.location.href = "{{ site.basepath }}/login";
   });
</script>

</head>

<body class="fixed-nav sticky-footer bg-dark" id="page-top">
  {% include admin/navbar.html %}

<div class="content-wrapper">
   <div class="container-fluid">
   <div id="profile-cont" class="col-md-12 mt-3">
      <div class="row mb-4 mt-2">
          <div class="col-md-12">
              <h3 class="text-center">Profili</h3>
          </div>
      </div>
      <div class="row">
         <div class="col-md-1"></div>
         <div class="col-md-10">
              <table class="table profile table-hover">
                  <thead>
                      <th id="profile-header" colspan="2">Të dhënat e profilit</th>
                  </thead>
                  <tbody>
                      <tr>
                          <th>Administratori:</th>
                          <td id="fullName"></td>
                      </tr>
                      <tr>
                          <th>Email:</th>
                          <td id="email"></td>
                      </tr>
                  </tbody>
              </table>
              <div class="col-md-12 change-btns">
                  <button class='btn btn-primary' id="change-password-btn" data-toggle="modal" style='margin-top: 10px;' data-target="#change-password-modal">
                     Ndrysho fjalëkalimin
                  </button>
              </div>
         </div>
      </div>
   </div>

   <div style="display: none" id="data-cont" class="col-md-12 mt-3">
      <div class="row mb-4 mt-2">
          <div class="col-md-12">
              <h3 class="text-center mb-5">Të dhënat</h3>
              <div class="row">
                 <div class="col-md-4"></div>
                 <div class="col-md-4">
                     <form id="import-data-form">
                        <label class="custom-file" id="customFile">
                          <input type="file" class="custom-file-input" id="exampleInputFile" aria-describedby="fileHelp">
                          <span class="custom-file-control form-control-file"></span>
                        </label><br/></br>

                        <button type="submit" class="btn btn-block btn-primary">Importo</button>
                     </form>
                 </div>
          </div>
      </div>

   </div>
</div>

{% include admin/footer.html %}
